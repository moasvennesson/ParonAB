<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <title>Extended Form with Calculation</title>
  <style>
    /* Add any additional custom styles here */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Extended Form with Calculation</h2>
  
  <form id="myForm">
    <div class="form-group">
      <label for="dropdown1">Dropdown 1:</label>
      <select class="form-control" id="dropdown1">
        <option value="1">Option 1</option>
        <option value="2">Option 2</option>
        <option value="3">Option 3</option>
      </select>
    </div>

    <div class="form-group">
      <label for="dropdown2">Dropdown 2:</label>
      <select class="form-control" id="dropdown2">
        <option value="A">Option A</option>
        <option value="B">Option B</option>
        <option value="C">Option C</option>
      </select>
    </div>

    <div class="form-group">
      <label>Transaction Type:</label>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="transactionType" id="inLager" value="In till lager">
        <label class="form-check-label" for="inLager">In till lager</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="transactionType" id="utUrLager" value="Ut ur lager">
        <label class="form-check-label" for="utUrLager">Ut ur lager</label>
      </div>
    </div>

    <div class="form-group">
      <label for="quantity">Quantity:</label>
      <input type="number" class="form-control" id="quantity" placeholder="Enter quantity">
    </div>

    <button type="button" class="btn btn-primary" onclick="submitForm()">Submit</button>
  </form>

  <div id="resultsContainer">
    <h3>Submitted Forms</h3>
    <ul id="resultsList" class="list-group">
      <!-- The list of submitted forms will be displayed here -->
    </ul>
    <p id="totalSum"><strong>Total Sum:</strong> 0</p>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
  // Function to submit the form
  function submitForm() {
    // Get selected values
    var dropdown1Value = parseInt(document.getElementById('dropdown1').value);
    var dropdown2Value = document.getElementById('dropdown2').value;

    // Get selected transaction type
    var transactionType = document.querySelector('input[name="transactionType"]:checked');
    var transactionTypeValue = transactionType ? transactionType.value : '';

    // Get quantity value
    var quantityValue = parseInt(document.getElementById('quantity').value);

    // Calculate the sum based on the selected options and quantity
    var sum = 0;

    if (!isNaN(dropdown1Value) && !isNaN(quantityValue)) {
      sum += dropdown1Value * quantityValue;
    }

    if (dropdown2Value === 'A' || dropdown2Value === 'B' || dropdown2Value === 'C' && !isNaN(quantityValue)) {
      sum += quantityValue;
    }

    // Create an object to store the form data and sum
    var formData = {
      dropdown1: dropdown1Value,
      dropdown2: dropdown2Value,
      transactionType: transactionTypeValue,
      quantity: quantityValue,
      sum: sum
    };

    // Get existing submitted forms from localStorage or initialize an empty array
    var submittedForms = JSON.parse(localStorage.getItem('submittedForms')) || [];

    // Add the current form data to the array
    submittedForms.push(formData);

    // Save the updated array back to localStorage
    localStorage.setItem('submittedForms', JSON.stringify(submittedForms));

    // Update the displayed list and total sum
    updateResultsList();
  }

  // Function to update the displayed list of submitted forms and total sum
  function updateResultsList() {
    // Get the container for results
    var resultsListContainer = document.getElementById('resultsList');
    var totalSumContainer = document.getElementById('totalSum');

    // Clear the existing content
    resultsListContainer.innerHTML = '';

    // Get submitted forms from localStorage
    var submittedForms = JSON.parse(localStorage.getItem('submittedForms')) || [];

    // Initialize total sum
    var totalSum = 0;

    // Create list items for each submitted form and append them to the list
    submittedForms.forEach(function (formData) {
      var listItem = document.createElement('li');
      listItem.className = 'list-group-item';
      listItem.innerHTML = `
        <strong>Dropdown 1:</strong> ${formData.dropdown1}<br>
        <strong>Dropdown 2:</strong> ${formData.dropdown2}<br>
        <strong>Transaction Type:</strong> ${formData.transactionType}<br>
        <strong>Quantity:</strong> ${formData.quantity}<br>
        <strong>Sum:</strong> ${formData.sum}
      `;

      resultsListContainer.appendChild(listItem);

      // Accumulate total sum
      totalSum += formData.sum;
    });

    // Display the total sum
    totalSumContainer.innerHTML = `<strong>Total Sum:</strong> ${totalSum}`;
  }

  // Initialize the displayed list on page load
  updateResultsList();
</script>

</body>
</html>
